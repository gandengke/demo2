CataTableInfoUpdateTenantStep {
    formatUpdateSql4HisTable{
        valueUpdate="""
        (
            {0}    ,
            {1}    ,
            ''{2}'',
            ''{3}'',
            ''{4}'',
            ''{5}'',
            ''{6}'',
            ''{6}'',
            ''{7}'',
            {8}    ,
            ''{9}''   ,
            {10}   ,
            ''{11}''
        )
        """
    }
    getTableData{
        fieldNames="id,account_id,main_account_name,sub_account_name,database_name,table_name,table_comment,table_storage_size,table_data_update_time,status,yn,create_time,table_row_count",
        searchTemplate="""
        SELECT
            id                    ,
            account_id            ,
            main_account_name     ,
            sub_account_name      ,
            database_name         ,
            table_name            ,
            table_comment         ,
            table_storage_size    ,
            table_data_update_time,
            status                ,
            yn                    ,
            create_time           ,
            table_row_count
        FROM
            ea_create_table_info tb_info
            JOIN
                (
                    SELECT
                        account_id AS db_account_id
                    FROM
                        ea_database
                    WHERE
                        bdp_prod_account  = ''{0}''
                        AND account_id    = {1}
                        AND database_name = ''{2}''
                        AND yn            = 1
                )
                db_info
            ON
                db_info.db_account_id = tb_info.account_id
        WHERE
            tb_info.yn         = 1
            AND tb_info.status = 0
        """

    }
    updateCata2Mysql{
        updateTemplate="""
        INSERT INTO
            ea_create_table_info
            (
                id                    ,
                account_id            ,
                main_account_name     ,
                sub_account_name      ,
                database_name         ,
                table_name ,
                table_comment         ,
                table_description     ,
                table_storage_size    ,
                table_data_update_time,
                update_time           ,
                table_row_count,
                partition_key
            )
            VALUES {0} ON DUPLICATE KEY
        UPDATE
            table_storage_size = VALUES
            (
                table_storage_size
            )
            ,
            table_data_update_time = VALUES
            (
                table_data_update_time
            )
            ,
            table_row_count = VALUES
            (
                table_row_count
            )
            ,
            update_time = VALUES
            (
                update_time
            ),
            partition_key = VALUES
            (
                partition_key
            )
            ;
        """
      }
    formatDeleteSql4ExpriedTable{
        deleteExpriedTemplate="""
          SELECT
            id
          FROM
            ea_create_table_info
          WHERE
            database_name    = ''{0}''
            AND account_id   = ''{1}''
            AND update_time != ''{2}''
            AND status       = 0
            AND yn           = 1
        """,
        updateTemplate="""
            UPDATE ea_create_table_info SET yn = 0, update_time = ''{0}'' WHERE id IN({1})
        """
    }
}
TableMetaUtil{
    writeTableToMysql{
        searchTable="""
             SELECT
                id
             FROM
                ea_create_table_info
             WHERE
                database_name  = ''{0}''
                AND table_name = ''{1}''
                AND yn         = 1
                AND status     = 0
             """,
         updateTable="""
            UPDATE
                ea_create_table_info
            SET
                table_storage_size     = ''{0}'',
                table_data_update_time = ''{1}'',
                update_time            = ''{2}'',
                source                 = {3}    ,
                table_row_count        = {4}    ,
                partition_key          = ''{5}'',
                department_id=''{6}''
            WHERE
                id = {7}
            """,
        insertTable="""
            INSERT
            INTO
            	ea_create_table_info
            	(
            		account_id            ,
            		main_account_name     ,
            		sub_account_name      ,
            		dataBase_name         ,
            		table_name            ,
            		table_comment         ,
            		table_description     ,
            		table_storage_size    ,
            		table_data_update_time,
            		status                ,
            		yn                    ,
            		create_time           ,
            		update_time           ,
            		source                ,
            		table_row_count       ,
            		partition_key,
            		department_id
            	)
            	VALUES
            	(
            		{0}    ,
            		''{1}'',
            		''{2}'',
            		''{3}'',
            		''{4}'',
            		''{5}'',
            		''{5}'',
            		''{6}'',
            		''{7}'',
            		0      ,
            		1      ,
            		''{8}'',
            		''{8}'',
            		{9}   ,
            		{10},
            		''{11}'',
            		''{12}''
            	) ;
            """
    }
}